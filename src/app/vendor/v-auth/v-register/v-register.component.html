<nb-layout>
  <nb-layout-header>
      <h4 class='text-center text-muted w-100'>ثبت نام</h4>
  </nb-layout-header>
  <nb-layout-column >
      <div class="row m-0 p-0 justify-content-center w-100  align-content-center "  style="height:100%">
          <div class="col-md-8 col-sm-8 col col-12 m-0 p-0 ">
            <nb-card *ngIf="step == 1">

              <nb-card-body>
                <form [formGroup]="form">
                  <div class="row">
                    <div class="col-12 col-sm-6 col-md-6">
                      <label for="brand_name" class="p-3">نام فروشگاه</label>
                      <input  formControlName="brand_name"  [status]="(form.controls['brand_name'].dirty && form.controls['brand_name'].invalid  && form.controls['brand_name'].touched ) ||checking.value == true  ? 'danger': (form.controls['brand_name'].dirty && form.controls['brand_name'].valid  && form.controls['brand_name'].touched && checking.value == false )? 'success' : 'basic' " type="text" nbInput fullWidth >
                    </div>
        
                    <div class="col-12 col-sm-6 col-md-6">
                      <label for="office_phone" class="p-3">شماره تماس</label>
                      <input appOnlyNumbers  formControlName="office_phone"  [status]="(form.controls['office_phone'].dirty && form.controls['office_phone'].invalid  && form.controls['office_phone'].touched ) ? 'danger': (form.controls['office_phone'].dirty && form.controls['office_phone'].valid  && form.controls['office_phone'].touched )? 'success' : 'basic' " type="text" nbInput fullWidth >
                    </div>
        
        
                    <div class="col-12 col-sm-6 col-md-6">
                      <label for="province_id" class="p-3">استان</label>
                      <nb-select [status]="(form.controls['province_id'].dirty && form.controls['province_id'].invalid  ) ? 'danger': (form.controls['province_id'].dirty && form.controls['province_id'].valid )? 'success' : 'basic' " formControlName="province_id" fullWidth>
                        <nb-option *ngFor="let item of provinces" [value]="item.id">{{item.name}}</nb-option>
                      </nb-select>
                    </div>
        
                    <div class="col-12 col-sm-6 col-md-6">
                      <label  for="city_id" class="p-3">شهر</label>
                      <nb-select [status]="(form.controls['city_id'].dirty && form.controls['city_id'].invalid  ) ? 'danger': (form.controls['city_id'].dirty && form.controls['city_id'].valid )? 'success' : 'basic' " formControlName="city_id" fullWidth>
                        <nb-option *ngFor="let item of cities" [value]="item.id">{{item.name}}</nb-option>
                      </nb-select>
                    </div>
        
        
                        
                    <div class="col-12 col-sm-12 col-md-12">
                      <label for="address" class="p-3">آدرس</label>
                      <textarea  formControlName="address"  [status]="(form.controls['address'].dirty && form.controls['address'].invalid  && form.controls['address'].touched ) ? 'danger': (form.controls['address'].dirty && form.controls['address'].valid  && form.controls['address'].touched )? 'success' : 'basic' " type="text" id="address" nbInput fullWidth ></textarea>
                    </div>
                  
                  
                    <div class="col-md-12">
        
                      <div class="row">
                        <div class="col-md-6 col-sm-6 col-12">
                          <label for="owner_first_name" class="p-3">نام</label>
                          <input 
                            nbInput
                            fullWidth
                            type="text"
                            [status]="(form.controls['owner_first_name'].dirty && form.controls['owner_first_name'].invalid  && form.controls['owner_first_name'].touched ) ? 'danger': (form.controls['owner_first_name'].dirty && form.controls['owner_first_name'].valid  && form.controls['owner_first_name'].touched )? 'success' : 'basic' "
                            formControlName="owner_first_name" id="owner_first_name" >
                        </div>
                        
                        <div class="col-md-6 col-sm-6 col-12">
                          <label for="owner_last_name" class="p-3">نام خانوادگی</label>
                          <input 
                            nbInput 
                            fullWidth 
                            type="text"
                            [status]="(form.controls['owner_last_name'].dirty && form.controls['owner_last_name'].invalid  && form.controls['owner_last_name'].touched ) ? 'danger': (form.controls['owner_last_name'].dirty && form.controls['owner_last_name'].valid  && form.controls['owner_last_name'].touched )? 'success' : 'basic' "
                            formControlName="owner_last_name">
                        </div>
        
        
                        <div class="col-md-12 col-12 col-sm-12">
                          <label for="owner_call_number" class="p-3">شماره مبایل</label>
                          <input type="text" 
                            nbInput
                            fullWidth
                            appOnlyNumbers
                            [status]="(form.controls['owner_call_number'].dirty && form.controls['owner_call_number'].invalid  && form.controls['owner_call_number'].touched ) ? 'danger': (form.controls['owner_call_number'].dirty && form.controls['owner_call_number'].valid  && form.controls['owner_call_number'].touched )? 'success' : 'basic' "
                            formControlName="owner_call_number">
                        </div>
        
                        <div class="col-md-12 mt-5 col-12 col-sm-12">
                          <button type="button"  (click)="callNumberConfirm()" size="small" [disabled]="form.invalid || checking.value != false " fullWidth shape="semi-round" nbButton [status]="submitStepOne ? 'info':'primary'"  >
        
      

                            {{submitStepOne ? '' : 'تایید'}}
                            <div *ngIf="submitStepOne" class="spinner-border spinner-border-sm small text-light  " role="status">
                              <span class="sr-only"></span>
                            </div>
        
                          </button>
                        </div>
        
                      </div>
                
                    </div>
        
                  
                  
                  </div>
        
        
        
        
        
                </form>
              </nb-card-body>
            </nb-card>
        
        
            <nb-card *ngIf="step == 2">
              <nb-card-header>
                <h4 class="text-center">تایید شماره موبایل</h4>
              </nb-card-header>
              <nb-card-body>
            
                <div class="row  ">
                  
                  <div class="col-md-12 text-center">
                    <p class="text-right mt-1">کد فعال سازی به شماره موبایل {{form.controls['owner_call_number'].value}} ارسال شد</p>
                    <app-v-confirm (code)="setCode($event)"></app-v-confirm>
                  </div>
        
                  <div class="col-md-12 mt-5">
                    
                    <div class="row justify-content-center">
                      <div class="col-md-4 col-sm-4  col-12">
                        <button [disabled]="form.controls['code'].value?.trim().length != 6" (click)="submit()" class="text-center" size="small" shape="semi-round" type="submit" nbButton fullWidth [status]="submitStepTwo ? 'info':'primary'" >

                          {{submitStepTwo ? '' : 'تایید'}}
                          <div *ngIf="submitStepTwo" class="spinner-border spinner-border-sm small text-light  " role="status">
                            <span class="sr-only"></span>
                          </div>
                        </button>
                      </div>
                    </div>
        
                  </div>
                </div>
        
        
        
              </nb-card-body>
            </nb-card>
         
          </div>
      </div>
  </nb-layout-column>

  <nb-layout-footer>
      <h4 class='text-center text-muted w-100'>خانه میوه</h4>
  </nb-layout-footer>
</nb-layout>




